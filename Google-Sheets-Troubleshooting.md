# ุฏููู ุญู ูุดุงูู Google Sheets Integration

## ๐จ ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุงูุญููู

### 1. ุงูุจูุงูุงุช ูุง ุชุตู ุฅูู Google Sheets

#### ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:
- **ูุดููุฉ ูู ุตูุงุญูุงุช Google Apps Script**
- **ุฎุทุฃ ูู ุฑุงุจุท Web App**
- **ูุดููุฉ ูู ุฅุนุฏุงุฏุงุช CORS**
- **ุฎุทุฃ ูู ุจููุฉ ุงูุจูุงูุงุช ุงููุฑุณูุฉ**

#### ุฎุทูุงุช ุงูุชุดุฎูุต:

1. **ุงูุชุญ Developer Console** (ุงุถุบุท F12)
2. **ุงูุชูู ุฅูู ุชุจููุจ Console**
3. **ุฃูุดุฆ ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ูุฑุงูุจ ุงูุฑุณุงุฆู**

#### ุงูุฑุณุงุฆู ุงููุชููุนุฉ:
```
๐ ุจุฏุก ุนูููุฉ ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Google Sheets...
๐ค ุงูุจูุงูุงุช ุงููุฑุณูุฉ: [ูุงุฆู JSON]
๐ ุฑุงุจุท API: [ุงูุฑุงุจุท]
๐จ ุงุณุชุฌุงุจุฉ ุงูุฎุงุฏู: 200 OK
โ ูุชูุฌุฉ ุงูุฅุฑุณุงู: [ุงููุชูุฌุฉ]
```

### 2. ุฃุฎุทุงุก CORS

ุฅุฐุง ุธูุฑุช ุฑุณุงูุฉ ุฎุทุฃ ุชุญุชูู ุนูู "CORS":

1. **ุชุญูู ูู ุฅุนุฏุงุฏุงุช Google Apps Script**
2. **ุชุฃูุฏ ูู ุฃู Web App ููุดูุฑ ููุนููู**
3. **ุชุญูู ูู ุฃู ุงูุตูุงุญูุงุช ุตุญูุญุฉ**

### 3. ุฎุทุฃ HTTP 403 (Forbidden)

```
โ HTTP Error 403: Forbidden
```

**ุงูุญู:**
1. ุงูุชูู ุฅูู Google Apps Script
2. ุชุฃูุฏ ูู ุฃู Web App ููุดูุฑ ูู "Anyone"
3. ุฃุนุฏ ูุดุฑ Web App ูุน ุฑูู ุฅุตุฏุงุฑ ุฌุฏูุฏ

### 4. ุฎุทุฃ HTTP 404 (Not Found)

```
โ HTTP Error 404: Not Found
```

**ุงูุญู:**
- ุชุญูู ูู ุตุญุฉ ุฑุงุจุท Web App ูู ุงููุชุบูุฑ `GOOGLE_APPS_SCRIPT_URL`

### 5. ุงูุจูุงูุงุช ุชุตู ูููู ูุง ุชุธูุฑ ูู ุงูุฌุฏูู

**ุงูุญู:**
1. ุชุญูู ูู ุงุณู ุงูุฌุฏูู ูู Google Apps Script
2. ุชุฃูุฏ ูู ุฃู ุงูุฃุนูุฏุฉ ุตุญูุญุฉ (A, B, C, D, E, F)
3. ุชุญูู ูู ุตูุงุญูุงุช ุงููุชุงุจุฉ ูู ุงูุฌุฏูู

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

ุงุณุชุฎุฏู ููู `test-google-sheets.html` ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู:

1. **ุงูุชุญ ุงูููู ูู ุงููุชุตูุญ**
2. **ุงุถุบุท "ุงุฎุชุจุงุฑ ุงูุงุชุตุงู"**
3. **ุงุถุบุท "ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุจูุงูุงุช ุชุฌุฑูุจูุฉ"**
4. **ุฑุงูุจ ุงููุชุงุฆุฌ**

## ๐ ุงูุชุณุฌูู ุงููุฏูู (ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ)

ุฅุฐุง ูุดู ุงูุฅุฑุณุงู ุงูุชููุงุฆูุ ุณุชุฌุฏ ุงูุจูุงูุงุช ูู Console:

```
๐ ุจูุงูุงุช ุงููุงุชูุฑุฉ ููุชุณุฌูู ุงููุฏูู ูู Google Sheets:
๐ ุงูุตู 1:
   ุงูุนููุฏ A (ุฑูู ุงููุงุชูุฑุฉ): 520250801
   ุงูุนููุฏ B (ุงูุชุงุฑูุฎ): ูจ ุฃุบุณุทุณ ูขููขูฅ
   ุงูุนููุฏ C (ุงุณู ุงูุนููู): ุนููู ูุฑูู
   ุงูุนููุฏ D (ุงุณู ุงูุตูู): ุฏููุงุช ุดููููุงุชุฉ
   ุงูุนููุฏ E (ุงููููุฉ): 2
   ุงูุนููุฏ F (ุงูุณุนุฑ): 15.50
```

## ๐ง ุฅุนุฏุงุฏุงุช Google Apps Script

### ุงูุชุญูู ูู ุงูููุฏ:

```javascript
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    
    if (data.action === 'addInvoiceItems') {
      return addInvoiceItems(data);
    }
    
    return ContentService
      .createTextOutput(JSON.stringify({success: false, message: 'Invalid action'}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, message: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
```

### ุงูุชุญูู ูู ุงูุตูุงุญูุงุช:

1. ุงูุชูู ุฅูู **Deploy > Manage Deployments**
2. ุชุฃูุฏ ูู ุงูุฅุนุฏุงุฏุงุช:
   - **Type:** Web app
   - **Execute as:** Me
   - **Who has access:** Anyone

## ๐ ุงูุฏุนู ุงูููู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:

1. **ุชุญูู ูู ุตุญุฉ ุฑุงุจุท Google Sheets**
2. **ุชุฃูุฏ ูู ุฃู ุงูููู ููุณ ูุญููุงู ุจูููุฉ ูุฑูุฑ**
3. **ุฌุฑุจ ุฅูุดุงุก Google Apps Script ุฌุฏูุฏ**
4. **ุชุญูู ูู ุงุณุชูุฑุงุฑ ุงูุฅูุชุฑูุช**

## ๐ ุฅุนุงุฏุฉ ุชุนููู ุงููุธุงู

ูุฅุนุงุฏุฉ ุชุนููู ูุงูู:

1. **ุงุญุฐู ุงูุจูุงูุงุช ุงููุญููุธุฉ ูุญููุงู:**
   ```javascript
   localStorage.clear();
   ```

2. **ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ**

3. **ุฌุฑุจ ูุงุชูุฑุฉ ุฌุฏูุฏุฉ**

---

**๐ก ูุตูุญุฉ:** ุงุญุชูุธ ุฏุงุฆูุงู ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูุจูุงูุงุช ูู Console ูู ุญุงูุฉ ูุดู ุงูุฅุฑุณุงู ุงูุชููุงุฆู.
