# ุฏููู ุญู ูุดููุฉ CORS ูุน Google Apps Script

## ๐จ ูุง ูู ูุดููุฉ CORSุ

CORS (Cross-Origin Resource Sharing) ูู ุขููุฉ ุฃูุงู ูู ุงููุชุตูุญุงุช ุชููุน ุงูุทูุจุงุช ุนุจุฑ ุงููุทุงูุงุช ุงููุฎุชููุฉ.

### ุฑุณุงูุฉ ุงูุฎุทุฃ:
```
Access to fetch at 'https://script.google.com/macros/s/...' 
from origin 'http://127.0.0.1:3000' has been blocked by CORS policy
```

## ๐ง ุงูุญููู ุงููุทุจูุฉ:

### 1. **ุชุบููุฑ ูู `cors` ุฅูู `no-cors`**
```javascript
// ูุจู ุงูุชุนุฏูู
fetch(url, { mode: 'cors' })

// ุจุนุฏ ุงูุชุนุฏูู
fetch(url, { mode: 'no-cors' })
```

### 2. **ูุนุงูุฌุฉ Opaque Response**
ูุน `no-cors`ุ ุงููุชุตูุญ ูุฑุณู ุงูุทูุจ ููู ูุง ูุณูุญ ุจูุฑุงุกุฉ ุงูุงุณุชุฌุงุจุฉ.

## ๐ ููููุฉ ุงูุชุญูู ูู ูุฌุงุญ ุงูุฅุฑุณุงู:

### ุงูุทุฑููุฉ ุงูุฃููู: Google Sheets ูุจุงุดุฑุฉ
1. ุงูุชุญ Google Sheets
2. ุชุญูู ูู ุธููุฑ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
3. ุงุจุญุซ ุนู ุฑูู ุงููุงุชูุฑุฉ

### ุงูุทุฑููุฉ ุงูุซุงููุฉ: Google Apps Script Logs
1. ุงูุชุญ Google Apps Script
2. ุงูุชูู ุฅูู **Executions** 
3. ุชุญูู ูู ุณุฌู ุงูุชูููุฐ

### ุงูุทุฑููุฉ ุงูุซุงูุซุฉ: Console Logs
```javascript
// ูู ุงููุธุงู ุงูุฌุฏูุฏ ุณุชุฑู:
โ ุชู ุฅุฑุณุงู ุงูุจูุงูุงุช (opaque response ูุน no-cors)
```

## ๐๏ธ ุฅุนุฏุงุฏุงุช Google Apps Script ุงููุทููุจุฉ:

### 1. **ุตูุงุญูุงุช ุงููุดุฑ**
```
Execute as: Me (owner email)
Who has access: Anyone
```

### 2. **ููุฏ doPost ุตุญูุญ**
```javascript
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    
    if (data.action === 'addInvoiceItems') {
      return addInvoiceItems(data);
    }
    
    return ContentService
      .createTextOutput(JSON.stringify({success: false, message: 'Invalid action'}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, message: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
```

## ๐ ุฎุทูุงุช ุญู ุงููุดููุฉ:

### ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช Apps Script
1. ุงูุชุญ Google Apps Script
2. ุชุฃูุฏ ูู ุงููุดุฑ ุงูุตุญูุญ
3. ุงูุณุฎ Web App URL ุงูุฌุฏูุฏ

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
```bash
# ุงูุชุญ test-google-sheets.html
# ุงุถุบุท "ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุจูุงูุงุช ุชุฌุฑูุจูุฉ"
# ุงุชุจุน ุงูุชุนูููุงุช
```

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู Google Sheets
1. ุงูุชุญ ุงูุฌุฏูู ูุจุงุดุฑุฉ
2. ุงุจุญุซ ุนู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
3. ุชุฃูุฏ ูู ุตุญุฉ ุงูุฃุนูุฏุฉ

## ๐ ุงูุจูุงูุงุช ุงููุฑุณูุฉ:

### ุชูุณูู JSON ุงููุทููุจ:
```json
{
  "action": "addInvoiceItems",
  "invoiceNumber": "520250801",
  "customerName": "ุงุณู ุงูุนููู",
  "date": "ูขููขูฅ/ูจ/ูจ",
  "items": [
    {
      "name": "ุฏููุงุช ุดููููุงุชุฉ",
      "quantity": 2,
      "price": 15.50
    }
  ]
}
```

### ุงูุฃุนูุฏุฉ ูู Google Sheets:
- **A**: ุฑูู ุงููุงุชูุฑุฉ
- **B**: ุงูุชุงุฑูุฎ  
- **C**: ุงุณู ุงูุนููู
- **D**: ุงุณู ุงูููุชุฌ
- **E**: ุงููููุฉ
- **F**: ุงูุณุนุฑ

## ๐ฏ ุนูุงูุงุช ุงููุฌุงุญ:

### ูู ูุธุงู ุงูููุงุชูุฑ:
```
โ ุชู ุญูุธ ุงููุงุชูุฑุฉ ูู Google Sheets!

ุฑูู ุงููุงุชูุฑุฉ: 520250801
ุนุฏุฏ ุงูุฃุตูุงู: 2

ููุงุญุธุฉ: ุชุญูู ูู Google Sheets ููุชุฃูุฏ ูู ูุตูู ุงูุจูุงูุงุช
```

### ูู Google Sheets:
- ุธููุฑ ุตููู ุฌุฏูุฏุฉ
- ุงูุจูุงูุงุช ูู ุงูุฃุนูุฏุฉ ุงูุตุญูุญุฉ
- ุฑูู ุงููุงุชูุฑุฉ ุตุญูุญ

## โ๏ธ ูุดุงูู ุดุงุฆุนุฉ:

### 1. **Web App URL ุฎุงุทุฆ**
```bash
โ HTTP Error 404: Not Found
โ ุชุญูู ูู ุฑุงุจุท Web App
```

### 2. **ุตูุงุญูุงุช ุฎุงุทุฆุฉ**
```bash
โ HTTP Error 403: Forbidden  
โ ุชุญูู ูู ุตูุงุญูุงุช ุงููุดุฑ
```

### 3. **ููุฏ Apps Script ุฎุงุทุฆ**
```bash
โ doPost: Cannot read properties of undefined
โ ุชุญูู ูู ููุฏ doPost
```

## ๐ ุงููุธุงู ุงูุฌุฏูุฏ ุงููุญุณู:

- โ **no-cors mode**: ุชุฌูุจ ูุดุงูู CORS
- โ **opaque response handling**: ูุนุงูุฌุฉ ุงูุงุณุชุฌุงุจุงุช ุงููุฎููุฉ
- โ **fallback verification**: ุงูุชุญูู ุงูุจุฏูู
- โ **detailed logging**: ุณุฌูุงุช ููุตูุฉ
- โ **user guidance**: ุฅุฑุดุงุฏุงุช ูุงุถุญุฉ

## ๐ก ูุตุงุฆุญ ูููุฉ:

1. **ุฏุงุฆูุงู ุชุญูู ูู Google Sheets** ุจุนุฏ ุงูุฅุฑุณุงู
2. **ุงุณุชุฎุฏู ุฑูู ุงููุงุชูุฑุฉ** ููุจุญุซ ูู ุงูุฌุฏูู
3. **ุฑุงูุจ Apps Script Executions** ููุฃุฎุทุงุก
4. **ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ** ูู ุงูุจูุงูุงุช ูู Console

---

**ุงูุฎูุงุตุฉ:** ูุดููุฉ CORS ุทุจูุนูุฉ ูุน ุงูุงุฎุชุจุงุฑ ุงููุญููุ ููู ุงููุธุงู ุงูุฌุฏูุฏ ูุชุนุงูู ูุนูุง ุจุฐูุงุก ููุถูู ูุตูู ุงูุจูุงูุงุช ุฅูู Google Sheets.
