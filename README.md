# 🍩 نظام إدارة الأعمال - دونات وحشوة

## 📋 نظرة عامة

نظام إدارة أعمال متكامل مصمم خصيصاً لمحل "دونات وحشوة" يشمل إدارة الفواتير، التوريد، والمدفوعات مع تكامل كامل مع Google Sheets وخدمات WhatsApp.

## 🎨 الهوية البصرية

### الألوان الرئيسية
- **اللون الأساسي**: `#dc218e` (وردي قوي)
- **اللون الثانوي**: `#ffb6bb` (وردي فاتح)
- **اللون المساعد**: `#ffeee6` (كريمي فاتح)

### الخط المستخدم
- **الخط الرئيسي**: Cairo (خط عربي أنيق)
- **الخط الاحتياطي**: Segoe UI, Tahoma, Geneva, Verdana

## 🏗️ هيكل المشروع

### الملفات الرئيسية

#### 📄 ملفات النظام الأساسية
- `index.html` - نظام الفواتير الرئيسي مع QR كود ZATCA
- `Data_supply.html` - نظام إدارة التوريد والعملاء والمنتجات
- `pay.html` - نظام إدارة المدفوعات والإيصالات
- `payment-receipt.html` - صفحة إيصال الدفع مع الطباعة الحرارية

#### 🎨 ملفات التصميم والموارد
- `styles.css` - ملف CSS الموحد لجميع الصفحات
- `saudi-qr-generator.js` - مولد QR كود متوافق مع معايير ZATCA السعودية
- `logo-01.png` - الشعار الرئيسي
- `new-logo.png` - الشعار البديل

#### ⚙️ ملفات البرمجة الخلفية
- `GoogleAppsScript-universal.gs` - سكريبت Google Apps Script لإدارة البيانات

## 🌟 المميزات الرئيسية

### 1. 💰 نظام الفواتير (`index.html`)
#### المميزات:
- ✅ إصدار فواتير احترافية مع QR كود سعودي متوافق مع ZATCA
- ✅ حساب تلقائي للضرائب (15%)
- ✅ إدارة العملاء والمنتجات
- ✅ حفظ تلقائي في Google Sheets
- ✅ طباعة فواتير احترافية
- ✅ إرسال مباشر عبر WhatsApp

#### مكونات QR كود ZATCA:
- اسم البائع
- الرقم الضريبي
- التاريخ والوقت
- إجمالي الفاتورة
- مبلغ الضريبة
- تشفير TLV متوافق مع المعايير السعودية

### 2. 📦 نظام التوريد (`Data_supply.html`)
#### المميزات:
- ✅ إدارة شاملة للعملاء
- ✅ إدارة المنتجات والمخزون
- ✅ تتبع عمليات التوريد
- ✅ تكامل مع قاعدة بيانات Google Sheets
- ✅ واجهة سهلة الاستخدام

#### قواعد البيانات:
- **العملاء**: الاسم، الهاتف، العنوان، نوع العميل
- **المنتجات**: اسم المنتج، السعر، الوصف، الفئة
- **التوريد**: تاريخ التوريد، المورد، المنتجات، الكميات

### 3. 💳 نظام المدفوعات (`pay.html`)
#### المميزات:
- ✅ تسجيل المدفوعات بطرق متعددة
- ✅ ربط بأرقام الفواتير
- ✅ حفظ تلقائي في Google Sheets
- ✅ إصدار إيصالات فورية
- ✅ طباعة حرارية بمقاس 57mm × 150mm

#### طرق الدفع المدعومة:
- كاش
- بطاقة ائتمان
- تحويل بنكي
- محفظة إلكترونية
- آجل

### 4. 🧾 نظام الإيصالات (`payment-receipt.html`)
#### المميزات:
- ✅ إيصالات احترافية بالهوية البصرية
- ✅ طباعة حرارية محسنة (57mm × 150mm)
- ✅ إرسال عبر WhatsApp
- ✅ أزرار التحكم: طباعة، واتساب، رئيسية، خروج
- ✅ عرض جميع تفاصيل الدفعة

#### مواصفات الطباعة الحرارية:
- **العرض**: 57mm
- **الارتفاع**: 150mm
- **خط كبير وواضح**: بدءاً من 12px
- **تنسيق مضغوط** مناسب للطابعات الحرارية
- **خط Cairo** للوضوح في الطباعة العربية

## 🔗 التكامل مع الخدمات الخارجية

### Google Sheets Integration
#### إعداد Google Apps Script:
```javascript
// معرف Google Sheets
const SHEET_ID = '1POl2ntUZL9x0n79Wr1_ZswEETSFUrgjMrXcFtDfoFqA';

// أوراق العمل:
- 'Customer_account' - بيانات العملاء
- 'invoices' - الفواتير
- 'Sales' - المبيعات
- 'balance' - الأرصدة
- 'payments' - المدفوعات
```

#### رابط Google Apps Script الحالي:
```
https://script.google.com/macros/s/AKfycbxvSfmuCxHMhrYigSo0j2wX0lsy0XiVHlBAaM3yoxHHnHKnOdTBX3vGAYeCnV9FGwdpTg/exec
```

#### تنسيق البيانات في الـ Sheets:
**ورقة payments:**
- العمود A: التاريخ
- العمود B: اسم العميل
- العمود C: رقم الفاتورة
- العمود D: المبلغ
- العمود E: طريقة الدفع
- العمود F: رقم الجوال
- العمود G: ملاحظات

### WhatsApp Integration
#### تنسيق رسائل WhatsApp:
- **للفواتير**: تفاصيل الفاتورة مع QR كود
- **للمدفوعات**: إيصال دفع مفصل
- **تنسيق الأرقام**: تحويل تلقائي لتنسيق +966

## 🎭 المميزات التجريبية

### 1. شاشة التحميل الإسلامية
#### المميزات:
- ✅ رسائل استغفار متناوبة كل ثانيتين
- ✅ شريط تقدم متحرك
- ✅ تأثيرات بصرية جذابة
- ✅ خلفية ضبابية (backdrop blur)

#### رسائل الاستغفار المستخدمة:
```javascript
const istighfarMessages = [
    "أستغفر الله العظيم",
    "أستغفر الله الذي لا إله إلا هو الحي القيوم وأتوب إليه",
    "رب اغفر لي ذنبي وخطئي وجهلي",
    "أستغفر الله العظيم الذي لا إله إلا هو الحي القيوم وأتوب إليه",
    "اللهم أنت ربي لا إله إلا أنت خلقتني وأنا عبدك"
];
```

### 2. نظام الإشعارات الخضراء
#### بديل للـ Alert التقليدي:
- ✅ إشعارات أنيقة بتصميم متقدم
- ✅ تختفي تلقائياً بعد 3 ثواني
- ✅ تأثيرات انتقالية سلسة
- ✅ ألوان متناسقة مع الهوية البصرية

## 🛠️ التقنيات المستخدمة

### Frontend Technologies
- **HTML5**: هيكل الصفحات
- **CSS3**: التصميم والتنسيق مع Flexbox و Grid
- **JavaScript ES6+**: البرمجة التفاعلية
- **Google Fonts**: خط Cairo
- **CSS Animations**: التأثيرات البصرية

### Backend & Integration
- **Google Apps Script**: معالجة البيانات
- **Google Sheets API**: قاعدة البيانات
- **WhatsApp Web API**: إرسال الرسائل
- **ZATCA QR Standards**: معايير QR السعودية

### Print Technology
- **CSS Print Media Queries**: تحسين الطباعة
- **Thermal Printing Support**: دعم الطابعات الحرارية
- **Custom Page Sizes**: أحجام صفحات مخصصة

## 📱 التصميم المتجاوب

### نقاط التوقف (Breakpoints):
```css
/* الهواتف الذكية */
@media (max-width: 768px) {
    .receipt-info { grid-template-columns: 1fr; }
    .actions { flex-direction: column; }
    .btn { width: 100%; }
}

/* الأجهزة اللوحية */
@media (min-width: 769px) and (max-width: 1024px) {
    .container { max-width: 90%; }
}

/* الشاشات الكبيرة */
@media (min-width: 1025px) {
    .container { max-width: 800px; }
}
```

## 🔧 دليل التطوير

### إضافة ميزة جديدة:
1. **إنشاء ملف HTML** جديد أو تحديث موجود
2. **إضافة CSS** في `styles.css` أو inline
3. **كتابة JavaScript** للوظائف التفاعلية
4. **تحديث Google Apps Script** إذا لزم الأمر
5. **اختبار التكامل** مع Google Sheets
6. **تطبيق نظام الألوان** والهوية البصرية

### إعداد Google Apps Script جديد:
```javascript
function doPost(e) {
  try {
    const requestData = JSON.parse(e.postData.contents);
    
    // فتح الـ Spreadsheet
    const spreadsheet = SpreadsheetApp.openById(SHEET_ID);
    const sheet = spreadsheet.getSheetByName('اسم_الورقة');
    
    // إعداد البيانات
    const rowData = [
      requestData.field1,
      requestData.field2,
      // ... المزيد من الحقول
    ];
    
    // كتابة البيانات
    const lastRow = sheet.getLastRow();
    sheet.getRange(lastRow + 1, 1, 1, rowData.length).setValues([rowData]);
    
    return createJsonResponse(true, 'تم الحفظ بنجاح');
  } catch (error) {
    return createJsonResponse(false, 'خطأ: ' + error.message);
  }
}
```

## 🎨 دليل التصميم

### استخدام الألوان:
```css
/* اللون الأساسي للعناصر المهمة */
.primary-color { color: #dc218e; }
.primary-bg { background: #dc218e; }

/* اللون الثانوي للخلفيات والحدود */
.secondary-color { color: #ffb6bb; }
.secondary-bg { background: #ffb6bb; }

/* اللون المساعد للخلفيات الفاتحة */
.accent-bg { background: #ffeee6; }

/* التدرجات */
.gradient-primary { 
  background: linear-gradient(135deg, #dc218e, #ffb6bb); 
}
```

### استخدام الخط:
```css
/* النص العادي */
.text-normal { 
  font-family: 'Cairo', sans-serif; 
  font-weight: 400; 
}

/* النص الثقيل */
.text-bold { 
  font-family: 'Cairo', sans-serif; 
  font-weight: 600; 
}

/* العناوين */
.heading { 
  font-family: 'Cairo', sans-serif; 
  font-weight: 700; 
}
```

## 🔄 سجل التحديثات

### الإصدار الأخير (أغسطس 2025)
- ✅ إضافة نظام إيصالات الدفع الكامل
- ✅ تحسين الطباعة الحرارية (57mm × 150mm)
- ✅ تطبيق الهوية البصرية الجديدة (ألوان وردية)
- ✅ تحسين فتح الإيصالات في نفس التبويب
- ✅ إضافة خط Cairo للوضوح
- ✅ تنظيف الكود وحذف الملفات غير الضرورية

### التحديثات السابقة
- ✅ تطوير نظام الفواتير مع QR كود ZATCA
- ✅ إضافة نظام التوريد والعملاء
- ✅ تكامل Google Sheets
- ✅ إضافة شاشة التحميل الإسلامية
- ✅ تطوير نظام الإشعارات الخضراء
- ✅ إضافة WhatsApp Integration

## 📋 دليل الاستخدام

### كيفية إضافة عميل جديد:
1. اذهب إلى `Data_supply.html`
2. املأ بيانات العميل في النموذج
3. اضغط "حفظ العميل"
4. سيتم حفظ البيانات تلقائياً في Google Sheets

### كيفية إصدار فاتورة:
1. اذهب إلى `index.html`
2. اختر العميل من القائمة المنسدلة
3. أضف المنتجات والكميات
4. اضغط "إنشاء الفاتورة"
5. ستظهر الفاتورة مع QR كود ZATCA
6. يمكن طباعتها أو إرسالها عبر WhatsApp

### كيفية تسجيل دفعة:
1. اذهب إلى `pay.html`
2. أدخل بيانات الدفعة
3. اختر طريقة الدفع
4. اضغط "حفظ الدفعة"
5. سيتم إنشاء إيصال تلقائياً
6. يمكن طباعة الإيصال حرارياً أو إرساله عبر WhatsApp

## 🧪 الاختبار والجودة

### اختبار الوظائف:
- ✅ اختبار حفظ البيانات في Google Sheets
- ✅ اختبار إنشاء QR كود ZATCA
- ✅ اختبار إرسال WhatsApp
- ✅ اختبار الطباعة العادية والحرارية
- ✅ اختبار التصميم المتجاوب

### معايير الجودة:
- ✅ كود منظف ومعلق
- ✅ تعامل مع الأخطاء
- ✅ واجهة مستخدم بديهية
- ✅ أداء سريع ومحسن
- ✅ أمان البيانات

## 🔐 الأمان والخصوصية

### إجراءات الأمان:
- ✅ حماية Google Apps Script endpoint
- ✅ عدم تخزين بيانات حساسة في localStorage
- ✅ تشفير البيانات المرسلة
- ✅ صلاحيات محدودة للـ Google Sheets

### خصوصية البيانات:
- ✅ عدم مشاركة بيانات العملاء مع أطراف ثالثة
- ✅ تخزين آمن في Google Sheets
- ✅ وصول محدود للبيانات
- ✅ حذف البيانات المؤقتة

## 🚀 خطة التطوير المستقبلية

### المميزات المقترحة:
- 📊 **تقارير مفصلة**: إحصائيات المبيعات والمدفوعات
- 📱 **تطبيق جوال**: نسخة محمولة من النظام
- 🔐 **نظام مستخدمين**: تسجيل دخول وأذونات
- 📈 **تحليلات متقدمة**: رسوم بيانية وتحليل البيانات
- 🔔 **إشعارات فورية**: تنبيهات للمدفوعات والفواتير
- 💾 **نسخ احتياطي**: نظام backup تلقائي

### تحسينات تقنية:
- ⚡ **تحسين الأداء**: تحميل أسرع وتفاعل محسن
- 🛡️ **الأمان**: تشفير البيانات الحساسة
- 🌐 **PWA**: تحويل لتطبيق ويب تقدمي
- 🔄 **Offline Mode**: عمل بدون إنترنت

## 🛠️ استكشاف الأخطاء

### مشاكل شائعة وحلولها:

#### 1. عدم حفظ البيانات في Google Sheets:
```javascript
// تأكد من صحة رابط Google Apps Script
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxvSfmuCxHMhrYigSo0j2wX0lsy0XiVHlBAaM3yoxHHnHKnOdTBX3vGAYeCnV9FGwdpTg/exec';

// تأكد من تنسيق البيانات
const payload = {
    type: 'payments',
    data: {
        // البيانات المطلوبة
    }
};
```

#### 2. مشاكل QR كود:
- تأكد من صحة بيانات ZATCA
- تحقق من تنسيق التاريخ والوقت
- تأكد من صحة الرقم الضريبي

#### 3. مشاكل الطباعة الحرارية:
```css
/* تأكد من إعدادات الطباعة الصحيحة */
@media print {
    @page {
        size: 57mm 150mm;
        margin: 0;
    }
    
    body {
        font-size: 12px;
        line-height: 1.2;
    }
}
```

#### 4. مشاكل WhatsApp:
- تأكد من تنسيق رقم الهاتف (+966)
- تحقق من نص الرسالة
- تأكد من أن المتصفح يدعم الروابط

## 📞 معلومات الدعم

### للدعم التقني:
- **Repository**: [jawednoor/donuts-system](https://github.com/jawednoor/donuts-system)
- **المطور**: Jawed Noor
- **آخر تحديث**: أغسطس 2025

### ملفات مهمة للرجوع إليها:
- `GoogleAppsScript-universal.gs` - للتعديل على قاعدة البيانات
- `payment-receipt.html` - لتخصيص الإيصالات
- `styles.css` - للتعديل على التصميم العام

### نصائح للصيانة:
1. **نسخ احتياطي دوري** لملفات Google Sheets
2. **مراقبة حدود Google Apps Script** (6 دقائق لكل execution)
3. **تحديث روابط WhatsApp** إذا تغيرت السياسات
4. **اختبار دوري** لجميع المميزات

### معلومات إضافية للمطورين:

#### بنية المشروع التقنية:
```
donuts-system/
├── index.html                    # نظام الفواتير الرئيسي
├── Data_supply.html             # نظام التوريد والعملاء
├── pay.html                     # نظام المدفوعات
├── payment-receipt.html         # إيصالات الدفع
├── styles.css                   # ملف CSS الموحد
├── saudi-qr-generator.js        # مولد QR السعودي
├── GoogleAppsScript-universal.gs # سكريبت قاعدة البيانات
├── logo-01.png                  # الشعار الرئيسي
├── new-logo.png                 # الشعار البديل
└── README.md                    # هذا الملف
```

#### متغيرات البيئة المهمة:
```javascript
// Google Sheets ID
const SHEET_ID = '1POl2ntUZL9x0n79Wr1_ZswEETSFUrgjMrXcFtDfoFqA';

// Google Apps Script URL
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxvSfmuCxHMhrYigSo0j2wX0lsy0XiVHlBAaM3yoxHHnHKnOdTBX3vGAYeCnV9FGwdpTg/exec';

// معلومات الشركة للفواتير
const COMPANY_INFO = {
    name: 'دونات وحشوة',
    vatNumber: '123456789012345',
    address: 'الرياض، المملكة العربية السعودية'
};
```

---

*هذا المشروع مطور خصيصاً لمحل "دونات وحشوة" ويحتوي على جميع المميزات اللازمة لإدارة الأعمال بكفاءة عالية.*

## 📜 رخصة الاستخدام

هذا المشروع مطور للاستخدام الداخلي لمحل "دونات وحشوة". جميع الحقوق محفوظة.
